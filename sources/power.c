/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   ft_printf.c                                        :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: bsausage <marvin@42.fr>                    +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2019/12/23 10:59:16 by bsausage          #+#    #+#             */
/*   Updated: 2019/12/23 10:59:17 by bsausage         ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "ft_printf.h"

//static int	g_array[3] = {1, 2, 3};

static ULL	g_five[11][81] = {{5, -1}, {25, -1}, {625, -1}, {390625, -1},
	{587890625, 152, -1},//4
	{962890625, 64365386, 23283, -1},//5
	{712890625, 434970855, 3726400, 242752217, 542101086, -1},//6
	{212890625, 863681793, 569604314, 377187926, 193021880, 454666389,
		305561419, 992184134, 705571876, 293873587, -1},//7
	{212890625, 471103668, 471103668, 747746862, 37770580, 37770580,
		466936530, 989468319, 635969950, 635969950, 939461496, 265605472,
		34722882, 579715075, 31624270, 701685918, 850237034, 644362813,
		711160003, 628003995, 253863518, 550944446, 86361685, -1},//8
	{212890625, 685947418, 789578832, 153319891, 326499008, 846968657,
		927433551, 646003612, 336516628, 337206058, 265350215, 297563699,
		3222742, 31686823, 588507120, 414217260, 63914765, 446554365,
		435262941, 204074266, 781377495, 260792318, 84691481, 164829592,
		302660486, 728095225, 101453412, 603255836, 803361511, 890400427,
		304936174, 385070118, 333206278, 894271518, 534600406, 837376471,
		315462933, 743290965, 731200206, 7458340, -1},//9
	{212890625, 115634918, 615430273, 882267024, 559966957, 411689217,
		227385153, 373527284, 321466491, 319349449, 971173152, 579376695,
		352174724, 684328083, 472418242, 579033069, 918822547, 857127117,
		153763503, 540464179, 604036185, 331102750, 570042246, 347786926,
		170285190, 941051121, 803070715, 141608771, 140794537, 294051183,
		662825734, 841586939, 586657834, 816037776, 222290074, 490239782,
		753719892, 802858809, 299810833, 527144151, 124802899, 838448395,
		770466127, 996414561, 126272884, 289511290, 843748736, 994522193,
		957621869, 897719252, 991212515, 499214790, 718012279, 416453973,
		270166265, 355209381, 173562593, 798039126, 64590901, 990253686,
		300058261, 269449838, 442970528, 400309634, 836502721, 810854038,
		895275128, 683493275, 775514101, 78975312, 954896357, 110870347,
		185422180, 295763833, 399511558, 101605480, 817933310, 34577255,
		846462680, 55626, -1}//10
		};

static ULL 	g_two[10][19] = {{2, -1}, {4, -1}, {16, -1}, {256, -1}, {65536, -1},
			{294967296, 4, -1}, {709551616, 446744073, 18, -1},
			{768211456, 374607431, 938463463, 282366920, 340, -1},//7
			{129639936, 584007913, 564039457, 984665640, 907853269, 985008687,
				195423570, 89237316, 115792, -1},//8
			{6084096, 946433649, 811946569, 853753882, 186486050, 690031858,
				166903427, 801874298, 73546976, 721764030, 723561443, 592393377,
				479365820, 205846127, 574024998, 942597099, 407807929, 13, -1}//9
		};

static void	fill_array_by_zero(ULL *arary)
{
	int		i;

	i = 0;
	while (i < MAX_RANK)
	{
		arary[i] = 0;
		i++;
	}
}

static void	copy_array(ULL *src, ULL *dest)
{
	int		i;

	i = 0;
	while (i < MAX_RANK && dest[i] != (ULL)(-1))
	{
		src[i] = dest[i];
		i++;
	}
	if (dest[i] == (ULL)(-1))
		src[i] = dest[i];
}

void		mult(ULL *m1, ULL *m2)
{
	ULL	result[MAX_RANK];
	unsigned long long		tmp;
	//long	rem;
	int		i;
	int		j;
	int		k;

	fill_array_by_zero(result);
	k = 0;
	j = 0;
	
	while (m2[j] != (ULL)(-1))
	{
		i = 0;
		tmp = 0;
		while (m1[i] != (ULL)(-1))
		{
			result[i + j] += m1[i] * m2[j] + tmp;
			tmp = result[i + j] / 1000000000;
			result[i + j] %= 1000000000;
			i++;
		}
		if (tmp)
			result[i + j] += tmp;
		j++;
	}
	/*while (m2[j] != -1)
	{
		i = 0;
		rem = 0;
		while (m1[i] != -1)
		{
	
			tmp = (unsigned long long)(m1[i] * m2[j] + rem);
			result[i + j] = (result[i + j] + tmp) % 1000000000;
			rem = (result[i + j] + tmp) / 1000000000;
			i++;
		}
		if (rem)
			result[i + j] += rem;
		j++;
	}*/
	result[i + j] = -1;
	copy_array(m1, result);
}


void		get_five_power(ULL *power, int exp)
{
	int		i;

	i = 0;
	if (exp < 0)
	{
		exp *= -1;
		while (exp)
		{
			if (exp & 1)
				mult(power, g_five[i]);
			exp = exp >> 1;
			i++;
		}
	}
	else
	{
		while (exp)
		{
			if (exp & 1)
				mult(power, g_two[i]);
			exp = exp >> 1;
			i++;
		}
	}
}

int			print_powers(void)
{
	int		i;
	ULL		power[MAX_RANK];

	fill_array_by_zero(power);
	copy_array(power, g_five[10]);
	mult(power, g_five[10]);
	i = 0;
	while (i < 200)
	{
		printf("{%lld}, ", power[i]);
		i++;
	}
	
	return (0);
}
