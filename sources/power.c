/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   ft_printf.c                                        :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: bsausage <marvin@42.fr>                    +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2019/12/23 10:59:16 by bsausage          #+#    #+#             */
/*   Updated: 2019/12/23 10:59:17 by bsausage         ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "ft_printf.h"

static ULL	g_five[9][12] = {
							{0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0},//0
							{0, 5, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0},//1
							{0, 25, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0},//2
							{0, 625, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0},//4
							{0, 390625, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0},//8
							{0, 587890625, 152, -1, 0, 0, 0, 0, 0, 0, 0, 0},//16
							{0, 962890625, 64365386, 23283, -1, 0, 0, 0, 0, 0, 0, 0},//32
							{0, 712890625, 434970855, 3726400, 242752217, 542101086, -1, 0, 0, 0, 0, 0},//64
							{0, 212890625, 863681793, 569604314, 377187926, 193021880, 454666389, 305561419, 992184134, 705571876, 293873587, -1},//128
							//{},//512
							//{},//1024
};


int mult_test(ULL *m1, ULL *m2)
{
	int		i;
	int		k;
	ULL		tmp[MAX_RANK];

	i = 0;
	while (i < MAX_RANK)
		tmp[i++] = 0;
	k = 1;
	while (m2[k] != (ULL)(-1))
	{
		i = 1;
		while (m1[i] != (ULL)(-1) && i + k - 1 < MAX_RANK)
		{
			tmp[i + k - 1] += m1[i] * m2[k];
			tmp[i + k - 1] += tmp[i + k - 2] / 1000000000;
			tmp[i + k - 2] %= 1000000000;
			i++;
		}
		k++;
	}
	//tmp[i + k - 1] += m1[i] * m2[k];
	//tmp[i + k - 1] += tmp[i + k - 2] / 1000000000;
	//tmp[i + k - 2] %= 1000000000;

	if (tmp[i + k - 1])
		tmp[i + k] = -1;
	else
		tmp[i + k - 1] = -1;
	i = 0;
	while (++i < MAX_RANK)
		m1[i] = tmp[i];
	return (0);
}

void	get(ULL *power, int exp)
{
	int		i = 1;

	if (exp < 0)
		exp *= -1;
	power[1] = 1;
	power [2] = -1;
	while (i < 9)
	{
		if (exp & (1 << i))
			mult_test(power, g_five[i]);
		i++;
	}
}

